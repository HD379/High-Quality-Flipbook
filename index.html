<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Flipbook Template – Rounded Corner Curl</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
  :root {
    --bg1: #fefaf3;
    --bg2: #f4f1ec;
    --bg3: #e8ded3;
    --page-bg: #ffffff;
    --text: #1f2228;
    --muted: #6e727b;
    --shadow-page: 0 18px 40px rgba(0, 0, 0, 0.2);
    --radius-page: 18px;
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: radial-gradient(circle at top left, var(--bg1) 0, var(--bg2) 50%, var(--bg3) 100%);
    color: var(--text);
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }

  .book-shell {
    width: 100vw;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .book {
    position: relative;
    width: 900px;   /* 2 x 450 */
    height: 600px;
    display: flex;
    perspective: 2000px;
  }

  .page {
    width: 50%;
    height: 100%;
    background: var(--page-bg);
    border-radius: var(--radius-page);
    box-shadow: var(--shadow-page);
    padding: 2rem 2.2rem;
    position: relative;
    overflow: hidden;
  }

  .page h2 {
    font-size: 0.83rem;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 0.4rem;
  }

  .page h1 {
    font-size: 1.3rem;
    margin-bottom: 0.8rem;
  }

  .page p {
    font-size: 0.96rem;
    line-height: 1.7;
    margin-bottom: 0.5rem;
  }

  .num {
    position: absolute;
    bottom: 18px;
    right: 20px;
    font-size: 0.8rem;
    color: var(--muted);
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  /* Rounded corner shading on static pages */
  .page::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: radial-gradient(circle at bottom right,
                rgba(0,0,0,0.16) 0,
                transparent 55%);
    opacity: 0.12;
  }

  /* Click zones */
  .hot {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 22%;
    cursor: pointer;
    z-index: 5;
  }
  #hot-left { left: 0; }
  #hot-right { right: 0; }

  .hint {
    position: absolute;
    bottom: 10px;
    font-size: 0.8rem;
    color: var(--muted);
    user-select: none;
    pointer-events: none;
  }
  .hint-left { left: 15px; }
  .hint-right { right: 15px; }

  /* Flip overlay – rounded, corner curl */
  .flip-overlay {
    position: absolute;
    top: 0;
    height: 100%;
    width: 50%;
    background: var(--page-bg);
    border-radius: var(--radius-page);
    box-shadow: var(--shadow-page);
    padding: 2rem 2.2rem;
    overflow: hidden;
    transform-style: preserve-3d;
    backface-visibility: hidden;
    pointer-events: none;
    z-index: 20;
  }

  .flip-overlay::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background:
      radial-gradient(circle at bottom right,
        rgba(0,0,0,0.25) 0,
        transparent 60%);
    opacity: 0.25;
    mix-blend-mode: multiply;
  }

  /* Forward (right-side) flip */
  .flip-overlay-right {
    right: 0;
    transform-origin: bottom right;
    animation: cornerFlipForward 0.8s cubic-bezier(0.2, 0.7, 0.3, 1) forwards;
  }

  /* Backward (left-side) flip */
  .flip-overlay-left {
    left: 0;
    transform-origin: bottom left;
    animation: cornerFlipBackward 0.8s cubic-bezier(0.2, 0.7, 0.3, 1) forwards;
  }

  @keyframes cornerFlipForward {
    0% {
      transform: rotateZ(0deg) rotateY(0deg) translate(0,0) scale(1);
      box-shadow: 0 18px 40px rgba(0,0,0,0.35);
    }
    40% {
      transform: rotateZ(3deg) rotateY(-85deg) translate(-20px,-6px) scale(1.03);
      box-shadow: 0 26px 60px rgba(0,0,0,0.45);
    }
    100% {
      transform: rotateZ(8deg) rotateY(-180deg) translate(-60px,-16px) scale(0.9);
      box-shadow: 0 0 0 rgba(0,0,0,0);
      opacity: 0;
    }
  }

  @keyframes cornerFlipBackward {
    0% {
      transform: rotateZ(0deg) rotateY(0deg) translate(0,0) scale(1);
      box-shadow: 0 18px 40px rgba(0,0,0,0.35);
    }
    40% {
      transform: rotateZ(-3deg) rotateY(85deg) translate(20px,-6px) scale(1.03);
      box-shadow: 0 26px 60px rgba(0,0,0,0.45);
    }
    100% {
      transform: rotateZ(-8deg) rotateY(180deg) translate(60px,-16px) scale(0.9);
      box-shadow: 0 0 0 rgba(0,0,0,0);
      opacity: 0;
    }
  }

  /* Scale down on smaller screens (simple but effective) */
  @media (max-width: 1000px) {
    .book { transform: scale(0.85); }
  }
  @media (max-width: 850px) {
    .book { transform: scale(0.7); }
  }
  @media (max-width: 700px) {
    .book { transform: scale(0.6); }
  }
  @media (max-width: 600px) {
    .book { transform: scale(0.5); }
  }
</style>
</head>
<body>

<div class="book-shell">
  <div class="book" id="book">
    <div class="page" id="left"></div>
    <div class="page" id="right"></div>

    <div class="hot" id="hot-left"></div>
    <div class="hot" id="hot-right"></div>

    <div class="hint hint-left">◀ Click / Arrow Left</div>
    <div class="hint hint-right">Click / Arrow Right ▶</div>
  </div>
</div>

<script>
  // Page data – replace with your real content later
  const pages = [
    {
      kicker: "10X City",
      title: "Flipbook Template · Page 1",
      body: [
        "You should see this as page 1 on the left and page 2 on the right.",
        "Click the right side (or press the right arrow key) to flip forward."
      ]
    },
    {
      kicker: "Intro",
      title: "Page 2 · Right Side",
      body: [
        "This is page 2. The flip animation uses a rounded corner curl.",
        "When you flip, you should see the new spread underneath the turning page."
      ]
    },
    {
      kicker: "Spread",
      title: "Page 3 · Left",
      body: [
        "Now you should see page 3 on the left, page 4 on the right.",
        "The corner turns from the bottom-right when you go forward."
      ]
    },
    {
      kicker: "Spread",
      title: "Page 4 · Right",
      body: [
        "Each flip reveals the next spread that is already rendered underneath."
      ]
    },
    {
      kicker: "Middle",
      title: "Page 5",
      body: [
        "This is page 5. We’re just giving you a few test spreads.",
        "Later, you can paste your own book content into the pages array."
      ]
    },
    {
      kicker: "Middle",
      title: "Page 6",
      body: [
        "We can adjust speed, curve and shadow if you want the flip to feel lighter or heavier."
      ]
    },
    {
      kicker: "Sample",
      title: "Page 7",
      body: [
        "Arrow keys also work: Left to go back, Right to go forward."
      ]
    },
    {
      kicker: "Sample",
      title: "Page 8",
      body: [
        "On touchscreens, tapping left / right will still trigger the animation."
      ]
    },
    {
      kicker: "Closing",
      title: "Page 9",
      body: [
        "This is the second-to-last test page."
      ]
    },
    {
      kicker: "Closing",
      title: "Page 10",
      body: [
        "Once you’re happy with this behavior, we’ll wire in your real 10X City content."
      ]
    }
  ];

  let index = 0; // left page index (0,2,4,...)
  let isAnimating = false;

  const leftEl = document.getElementById("left");
  const rightEl = document.getElementById("right");
  const bookEl = document.getElementById("book");

  function fillPage(el, data, num) {
    el.innerHTML = "";
    if (!data) return;

    if (data.kicker) {
      const h2 = document.createElement("h2");
      h2.textContent = data.kicker;
      el.appendChild(h2);
    }

    if (data.title) {
      const h1 = document.createElement("h1");
      h1.textContent = data.title;
      el.appendChild(h1);
    }

    if (Array.isArray(data.body)) {
      data.body.forEach(t => {
        const p = document.createElement("p");
        p.textContent = t;
        el.appendChild(p);
      });
    }

    const n = document.createElement("div");
    n.className = "num";
    n.textContent = num;
    el.appendChild(n);
  }

  function renderSpread() {
    if (index < 0) index = 0;
    if (index >= pages.length) {
      index = pages.length - (pages.length % 2 === 0 ? 2 : 1);
    }
    if (index % 2 !== 0) index -= 1;

    fillPage(leftEl, pages[index], index + 1);
    fillPage(rightEl, pages[index + 1], index + 2);
  }

  function createOverlay(side, oldHtml, onDone) {
    const overlay = document.createElement("div");
    overlay.classList.add("flip-overlay");
    if (side === "right") {
      overlay.classList.add("flip-overlay-right");
    } else {
      overlay.classList.add("flip-overlay-left");
    }
    overlay.innerHTML = oldHtml;

    overlay.addEventListener("animationend", () => {
      overlay.remove();
      if (typeof onDone === "function") onDone();
    });

    bookEl.appendChild(overlay);
  }

  function nextSpread() {
    if (isAnimating) return;
    if (index + 2 >= pages.length) return;

    isAnimating = true;

    // Save old right page content to animate
    const oldRightHtml = rightEl.innerHTML;

    // Move to new spread and render UNDERNEATH the flipping overlay
    index += 2;
    renderSpread();

    // Create overlay from old right page that curls away
    createOverlay("right", oldRightHtml, () => {
      isAnimating = false;
    });
  }

  function prevSpread() {
    if (isAnimating) return;
    if (index - 2 < 0) return;

    isAnimating = true;

    // Save old left page content to animate backwards
    const oldLeftHtml = leftEl.innerHTML;

    // Move to previous spread and render UNDERNEATH
    index -= 2;
    renderSpread();

    // Create overlay from old left page that curls back
    createOverlay("left", oldLeftHtml, () => {
      isAnimating = false;
    });
  }

  // Click zones
  document.getElementById("hot-right").addEventListener("click", nextSpread);
  document.getElementById("hot-left").addEventListener("click", prevSpread);

  // Keyboard
  document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowRight") nextSpread();
    if (e.key === "ArrowLeft") prevSpread();
  });

  // (Optional) very simple swipe detection
  let startX = null;
  function onPointerDown(e) {
    startX = e.touches ? e.touches[0].clientX : e.clientX;
  }
  function onPointerUp(e) {
    if (startX == null) return;
    const x = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
    const dx = x - startX;
    if (dx < -40) nextSpread();
    else if (dx > 40) prevSpread();
    startX = null;
  }
  bookEl.addEventListener("mousedown", onPointerDown);
  bookEl.addEventListener("mouseup", onPointerUp);
  bookEl.addEventListener("touchstart", onPointerDown, { passive: true });
  bookEl.addEventListener("touchend", onPointerUp, { passive: true });

  // Initial render
  renderSpread();
</script>

</body>
</html>
